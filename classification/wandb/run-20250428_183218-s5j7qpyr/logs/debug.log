2025-04-28 18:32:18,583 INFO    MainThread:68893 [wandb_setup.py:_flush():68] Current SDK version is 0.19.10
2025-04-28 18:32:18,583 INFO    MainThread:68893 [wandb_setup.py:_flush():68] Configure stats pid to 68893
2025-04-28 18:32:18,583 INFO    MainThread:68893 [wandb_setup.py:_flush():68] Loading settings from /home/syyan/.config/wandb/settings
2025-04-28 18:32:18,584 INFO    MainThread:68893 [wandb_setup.py:_flush():68] Loading settings from /home/share/FM_Code/PanDerm/classification/wandb/settings
2025-04-28 18:32:18,584 INFO    MainThread:68893 [wandb_setup.py:_flush():68] Loading settings from environment variables
2025-04-28 18:32:18,584 INFO    MainThread:68893 [wandb_init.py:setup_run_log_directory():724] Logging user logs to /home/share/FM_Code/PanDerm/classification/wandb/run-20250428_183218-s5j7qpyr/logs/debug.log
2025-04-28 18:32:18,584 INFO    MainThread:68893 [wandb_init.py:setup_run_log_directory():725] Logging internal logs to /home/share/FM_Code/PanDerm/classification/wandb/run-20250428_183218-s5j7qpyr/logs/debug-internal.log
2025-04-28 18:32:18,584 INFO    MainThread:68893 [wandb_init.py:init():852] calling init triggers
2025-04-28 18:32:18,584 INFO    MainThread:68893 [wandb_init.py:init():857] wandb.init called with sweep_config: {}
config: {'mode': 'train', 'batch_size': 128, 'epochs': 1, 'update_freq': 1, 'save_ckpt_freq': 5, 'model': 'PanDerm_Large_FT', 'rel_pos_bias': True, 'sin_pos_emb': True, 'layer_scale_init_value': 0.1, 'ood_eval': False, 'input_size': 224, 'drop': 0.0, 'attn_drop_rate': 0.0, 'drop_path': 0.2, 'weights': True, 'disable_eval_during_finetuning': False, 'model_ema': False, 'model_ema_decay': 0.9999, 'model_ema_force_cpu': False, 'percent_data': 1.0, 'TTA': False, 'monitor': 'recall', 'opt': 'adamw', 'opt_eps': 1e-08, 'opt_betas': None, 'clip_grad': None, 'momentum': 0.9, 'weight_decay': 0.05, 'weight_decay_end': None, 'lr': 0.0005, 'layer_decay': 0.65, 'warmup_lr': 1e-06, 'min_lr': 1e-06, 'warmup_epochs': 1, 'warmup_steps': -1, 'color_jitter': 0.4, 'aa': '', 'smoothing': 0.1, 'train_interpolation': 'bicubic', 'crop_pct': None, 'reprob': 0.25, 'remode': 'pixel', 'recount': 1, 'resplit': False, 'mixup': 0.8, 'cutmix': 1.0, 'cutmix_minmax': None, 'mixup_prob': 1.0, 'mixup_switch_prob': 0.5, 'mixup_mode': 'batch', 'pretrained_checkpoint': '/home/syyan/XJ/PanDerm-open_source/pretrain_weight/panderm_ll_data6_checkpoint-499.pth', 'model_key': 'model|module|state_dict', 'model_prefix': '', 'init_scale': 0.001, 'use_mean_pooling': True, 'disable_weight_decay_on_rel_pos_bias': False, 'data_path': '/datasets01/imagenet_full_size/061417/', 'eval_data_path': None, 'test_csv_path': None, 'image_key': 'image', 'nb_classes': 7, 'imagenet_default_mean_and_std': True, 'data_set': 'IMNET', 'csv_path': '/home/syyan/XJ/PanDerm-open_source/data/linear_probing/HAM-official-7-lp.csv', 'root_path': '/home/share/Uni_Eval/ISIC2018_reader/images/', 'output_dir': '/home/share/FM_Code/PanDerm/HAM_Res/', 'log_dir': None, 'device': 'cuda', 'seed': 122, 'resume': '', 'auto_resume': False, 'wandb_name': 'Reproduce_HAM_FT128_5e-4_122', 'save_ckpt': True, 'start_epoch': 0, 'eval': False, 'dist_eval': False, 'num_workers': 10, 'pin_mem': True, 'world_size': 1, 'local_rank': -1, 'dist_on_itp': False, 'dist_url': 'env://', 'enable_deepspeed': False, 'enable_linear_eval': False, 'enable_multi_print': False, 'exp_name': 'ham finetune and eval', '_wandb': {}}
2025-04-28 18:32:18,584 INFO    MainThread:68893 [wandb_init.py:init():893] starting backend
2025-04-28 18:32:18,584 INFO    MainThread:68893 [wandb_init.py:init():897] sending inform_init request
2025-04-28 18:32:18,591 INFO    MainThread:68893 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-04-28 18:32:18,591 INFO    MainThread:68893 [wandb_init.py:init():907] backend started and connected
2025-04-28 18:32:18,595 INFO    MainThread:68893 [wandb_init.py:init():1002] updated telemetry
2025-04-28 18:32:18,605 INFO    MainThread:68893 [wandb_init.py:init():1026] communicating run to backend with 90.0 second timeout
2025-04-28 18:32:19,354 INFO    MainThread:68893 [wandb_init.py:init():1101] starting run threads in backend
2025-04-28 18:32:19,482 INFO    MainThread:68893 [wandb_run.py:_console_start():2566] atexit reg
2025-04-28 18:32:19,482 INFO    MainThread:68893 [wandb_run.py:_redirect():2414] redirect: wrap_raw
2025-04-28 18:32:19,483 INFO    MainThread:68893 [wandb_run.py:_redirect():2483] Wrapping output streams.
2025-04-28 18:32:19,483 INFO    MainThread:68893 [wandb_run.py:_redirect():2506] Redirects installed.
2025-04-28 18:32:19,485 INFO    MainThread:68893 [wandb_init.py:init():1147] run started, returning control to user process
2025-04-28 18:33:41,025 INFO    MainThread:68893 [wandb_run.py:_finish():2314] finishing run mmai1/FM_FT_screening/s5j7qpyr
2025-04-28 18:33:41,026 INFO    MainThread:68893 [wandb_run.py:_atexit_cleanup():2531] got exitcode: 0
2025-04-28 18:33:41,027 INFO    MainThread:68893 [wandb_run.py:_restore():2513] restore
2025-04-28 18:33:41,027 INFO    MainThread:68893 [wandb_run.py:_restore():2519] restore done
2025-04-28 18:33:42,665 INFO    MainThread:68893 [wandb_run.py:_footer_history_summary_info():4160] rendering history
2025-04-28 18:33:42,666 INFO    MainThread:68893 [wandb_run.py:_footer_history_summary_info():4192] rendering summary
2025-04-28 18:33:42,667 INFO    MainThread:68893 [wandb_run.py:_footer_sync_info():4121] logging synced files
